/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2024 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use client";"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const Y=require("react"),H=require("prop-types"),U=require("../../components/BaseView.js"),a=require("@progress/kendo-date-math"),j=require("@progress/kendo-react-common"),_=require("../common/VerticalResourceIterator.js"),z=require("../common/HorizontalResourceIterator.js"),f=require("../../utils/index.js"),q=require("../../messages/index.js"),B=require("../../slots/SchedulerEditSlot.js"),F=require("@progress/kendo-react-intl"),O=require("../../constants/index.js"),W=require("../../services/rangeService.js"),K=require("../../services/slotsService.js"),Z=require("../../services/occurrenceService.js"),L=require("../../services/itemsService.js"),G=require("../../components/ShowMoreItemsButton.js"),J=require("../../items/SchedulerEditItem.js"),d=require("../../context/SchedulerContext.js"),N=require("../../context/SchedulerResourceIteratorContext.js"),Q=require("../../components/DateHeaderCell.js");function X(e){const s=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const o in e)if(o!=="default"){const i=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(s,o,i.get?i:{enumerable:!0,get:()=>e[o]})}}return s.default=e,Object.freeze(s)}const r=X(Y),ee={skeleton:"dd"},M=e=>{const{group:s,timezone:o,resources:i}=d.useSchedulerPropsContext(),y=e.editItem||J.SchedulerEditItem,E=e.editSlot||B.SchedulerEditSlot,[h]=d.useSchedulerDataContext(),[,C]=d.useSchedulerDateContext(),[,D]=d.useSchedulerActiveViewContext(),I=d.useSchedulerViewsContext(),T=d.useSchedulerGroupsContext(),w=d.useSchedulerOrientationContext(),l=d.useSchedulerDateRangeContext(),p=F.useInternationalization(),b=d.useSchedulerFieldsContext(),k=e.itemsPerSlot||P.itemsPerSlot,m=r.useMemo(()=>W.toRanges(l,{step:a.MS_PER_DAY*O.DAYS_IN_WEEK_COUNT,timezone:o}),[l.start.getTime(),l.end.getTime(),o]),S=r.useMemo(()=>K.toSlots(l,{step:a.MS_PER_DAY},{groups:T,ranges:m}),[l.start.getTime(),l.end.getTime(),T,m]),x=r.useMemo(()=>Z.toOccurrences(h,{dateRange:l,fields:b,timezone:o}),[h,l.start.getTime(),l.end.getTime(),b,o]),g=r.useMemo(()=>L.toItems(x,{timezone:o},{groups:T,ranges:m}),[x,o,T,m]),A=r.useCallback(t=>{const n=I.find(u=>u.props.name==="day");!D||!n||!n.props.name||!t.target.slot||(D(n.props.name,t),C(t.target.slot.start,t))},[D,I]);r.useMemo(()=>f.mapItemsToSlots(g,S,!0),[g,S]),r.useMemo(()=>f.mapSlotsToItems(g,S,!0),[g,S]);const v=r.createElement(N.SchedulerResourceIteratorContext.Consumer,null,({groupIndex:t})=>r.createElement("div",{className:"k-scheduler-row",key:t},S.filter(n=>n.group.index===t&&n.range.index===0).map((n,u)=>r.createElement(Q.DateHeaderCell,{as:e.dateHeaderCell,key:u,"data-dayslot-index":u,date:a.ZonedDate.fromLocalDate(new Date(n.zonedEnd.getTime()-(n.zonedEnd.getTime()-n.zonedStart.getTime())/2),o),start:n.start,end:n.end,format:{skeleton:"EEEE"}})))),V=r.createElement(N.SchedulerResourceIteratorContext.Consumer,null,({groupIndex:t})=>m.map((n,u)=>r.createElement("div",{className:"k-scheduler-row",key:u},S.filter(c=>c.group.index===t&&c.range.index===u).map((c,R,$)=>r.createElement(E,{slot:e.slot,viewSlot:e.viewSlot,key:R,form:e.form,...c,expandable:{offsetTop:30,offsetBottom:k<c.items.length?15:0},onDataAction:e.onDataAction,col:w==="horizontal"?$.length*(t||0)+R:R,row:w==="horizontal"?u:m.length*(t||0)+u,editable:e.editable},r.createElement("span",{className:"k-link k-nav-day"},p.formatDate(new Date(c.end.getTime()-(c.end.getTime()-c.start.getTime())/2),ee)),k<c.items.length&&r.createElement(G.ShowMoreItemsButton,{slot:c,onClick:A}))))));return r.createElement(U.BaseView,{props:e,slots:S,ranges:m,className:j.classNames("k-scheduler-monthview",e.className)},r.createElement("div",{className:"k-scheduler-head"},w==="horizontal"?r.createElement(z.HorizontalResourceIterator,{nested:!0,resources:i,group:s},v):r.createElement(_.VerticalResourceIterator,{resources:i,group:s},v)),r.createElement("div",{className:"k-scheduler-body"},w==="horizontal"?r.createElement(z.HorizontalResourceIterator,{resources:i,group:s},V):r.createElement(_.VerticalResourceIterator,{nested:!0,resources:i,group:s},V),g.filter(t=>t.order===null||t.order<k).sort(f.orderSort).map(t=>r.createElement(y,{item:e.item,viewItem:e.viewItem,form:e.form,key:t.isRecurring?`${t.uid}:${t.group.index}:${t.range.index}:${t.originalStart}`:`${t.uid}:${t.group.index}:${t.range.index}`,...t,onDataAction:e.onDataAction,style:{transform:"translateY(30px)"},vertical:!1,editable:e.editable,ignoreIsAllDay:!0}))))},te=({intl:e,date:s,timezone:o})=>{const i=a.firstDayInWeek(a.firstDayOfMonth(a.getDate(s)),e.firstDay()),y=a.addDays(a.firstDayInWeek(a.lastDayOfMonth(a.getDate(s)),e.firstDay()),O.DAYS_IN_WEEK_COUNT),E=a.ZonedDate.fromUTCDate(f.toUTCDateTime(i),o),h=a.ZonedDate.fromUTCDate(f.toUTCDateTime(y),o),C=new Date(E.getTime()),D=new Date(h.getTime());return{start:C,end:D,zonedStart:E,zonedEnd:h}},P={name:"month",dateRange:te,slotDuration:24*60,slotDivision:1,itemsPerSlot:2,numberOfDays:31,title:e=>e.toLanguageString(q.monthViewTitle,q.messages[q.monthViewTitle]),selectedDateFormat:"{0:Y}",selectedShortDateFormat:"{0:Y}"},re={itemsPerSlot:H.number};M.propTypes=re;M.displayName="KendoReactSchedulerMonthView";exports.MonthView=M;exports.monthViewDefaultProps=P;
